import { Link } from '@brillout/docpress'

VikeはNext.jsには異なる点が3つあります:

1.  VikeはUIフレームワークに囚われない。
    > VikeはReactに完全に依存せず、ソースコードもReactへの依存はゼロです。Vikeは他のUIフレームワーク（Vue、Preact、Solidなど）と一緒に使うことができます。
    >
    > Vikeでは、Reactインテグレーションを実装し、完全にコントロールすることができます。例えば、Next.jsでは不可能な、Facebookと同じ方法（render-as-you-fetchストリーム）でRelayを使用することができます。
1.  Vikeはサーバーやデプロイメントに囚われない。
    > Vikeを使えば、サーバーを完全にコントロールでき、どのようなデプロイメント戦略も利用できます。
1.  Vikeは本格的でありながらミニマル。
    > [すべての依存関係](https://github.com/vikejs/vike/blob/89073c8375d46af7cc05057a8f2efcd833273be6/vike/package.json#L4-L13)はViteと共有されるか （e.g. [`fast-glob`](https://github.com/mrmlnc/fast-glob)）、完全/移行的に所有されます（e.g. [`@brillout/json-serializer`](https://github.com/brillout/json-serializer)）。 VikeをViteアプリに追加しても、軽薄な依存関係は追加されません。
    >
    > 私たちは、Vikeが本格的なフロントエンドツールであると同時に、無駄なな課題やエラーを避けるというスイートスポットに当たると信じています。

このような構造的な違いに加え、Vikeは、Viteによる超高速HMR、 最先端のSPAサポート（特に今後の新しいVikeデザインによる）、ドメイン駆動型ファイル構造、最先端のコード分割（Vite/Rollupによる）、自動デプロイ同期、[独自のフレームワークの構築](https://vike.land)などの機能を導入しています。

> TurbopackはViteの超高速なDXテクニックの一部を再現していますが、まだ発展途上であり、Turbopackが本番に対応するまでにはしばらく時間がかかるでしょう。Viteを使えば、今すぐ光速なDXを使うことができます。

最後に、Vikeはコミュニティ・プロジェクトである。ビジネス上の利害が根本的に対立するフレームワークに依存するのではなく、コミュニティが主催し、コミュニティのために作られたコミュニティ主導のプロジェクトを利用しませんか？


## サーバーやデプロイメントに囚われない

サーバーの観点から言えば、Vikeはどこでも（AWS、Vercel、Cloudflare、Deno Deployなど）実行できる<Link text="ミドルウェア" href="/deploy" />に過ぎません。

Vikeを統合するには、Vikeのミドルウェアをサーバーに追加するだけです（Express.js、Fastify、Edge Worker、Serverless Functionなど）。

Vikeでは、アーキテクチャの最も重要な側面の1つであるサーバーとデプロイメントを完全にコントロールできます。


## 詳細の比較表

[@patryk-smc と @redbar0nによる](https://github.com/vikejs/vike/issues/158#issuecomment-1250068578):

|                                                                                               | Vike                                                                                       | Next.js                                                                                                                                                                                                                                               |
| --------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UI フレームワーク                                                                             | すべて (React, Preact, Solid, etc.)                                                        | React のみ                                                                                                                                                                                                                                            |
| コード分割とバンドル                                                                          | 可能                                                                                       | 可能                                                                                                                                                                                                                                                  |
| HMR                                                                                           | 可能 速い                                                                                  | 可能, 遅い                                                                                                                                                                                                                                            |
| SPA                                                                                           | 可能                                                                                       | 限定的                                                                                                                                                                                                                                                |
| <p align="center">**SSR**</p>                                                                 |                                                                                            |                                                                                                                                                                                                                                                       |
| コントロール                                                                                  | フルコントロール                                                                           | 限定的 / ブラックボックス                                                                                                                                                                                                                             |
| レンダラー                                                                                    | 可能、好きなだけ                                                                           | 一つのみ (`_app.ts` ファイル)                                                                                                                                                                                                                         |
| RSC (React サーバーコンポーネント)                                                            | 可能, <Link href="/react#react-server-components">部分的に</Link>                          | 可能、実験段階                                                                                                                                                                                                                                        |
| <p align="center">**ルーティング**</p>                                                        |                                                                                            |                                                                                                                                                                                                                                                       |
| ファイルシステムルーティング                                                                  | 可能                                                                                       | 可能                                                                                                                                                                                                                                                  |
| <Link text="ドメイン駆動ファイルシステムルーティング" href="/file-structure#domain-driven" /> | 可能                                                                                       | 不可                                                                                                                                                                                                                                                  |
| <Link text="クライアントルーティング" href="/client-routing" />                               | 可能                                                                                       | 可能                                                                                                                                                                                                                                                  |
| <Link text="サーバールーティング" href="/server-routing" />                                   | 可能                                                                                       | 不可                                                                                                                                                                                                                                                  |
| <Link text="ベースURL" href="/base-url" />                                                    | 可能                                                                                       | 限定的                                                                                                                                                                                                                                                |
| <p align="center">**統合**</p>                                                                |                                                                                            |                                                                                                                                                                                                                                                       |
| HTTP サーバー                                                                                 | なし\*、 自分で実装してください                                                            | カスタムサーバーは、注意事項とともに部分的にサポートされます[[1]](https://github.com/vikejs/vike/issues/158#issuecomment-1355306156)[[2]](https://stackoverflow.com/questions/58742343/do-i-have-to-use-express-in-next-js-project/70945468#70945468) |
| Apollo Client with SSR                                                                        | フルサポート                                                                               | 部分的にサポート                                                                                                                                                                                                                                      |
| Relay with SSR                                                                                | フルサポート                                                                               | 部分的にサポート                                                                                                                                                                                                                                      |
| <p align="center">**その他**</p>                                                              |                                                                                            |                                                                                                                                                                                                                                                       |
| Headコンポーネント                                                                            | なし\*、 [react-helmet](https://github.com/nfl/react-helmet)などのツールを使用してください | あり、 next/head                                                                                                                                                                                                                                      |
| Image component                                                                               | なし\*、 <Link href="/img">画像最適化ツール</Link>を用いてください                         | あり、 next/image                                                                                                                                                                                                                                     |
| API routes                                                                                    | なし\*、 自分のサーバーか<Link text="RPCツール" href="/api-routes" />を使用してください    | あり                                                                                                                                                                                                                                                  |
| Internationalization (i18n)                                                                   | 可能                                                                                       | 限定的                                                                                                                                                                                                                                                |
| <Link href="/deploy-sync" >デプロイの同期</Link>                                              | 可能                                                                                       | 不可                                                                                                                                                                                                                                                  |
| [独自のフレームワークを構築](https://vike.land)                                               | 可能                                                                                       | 不可                                                                                                                                                                                                                                                  |
| <p align="center">**デプロイオプション**</p>                                                  |                                                                                            |                                                                                                                                                                                                                                                       |
| Vercel                                                                                        | 最低限の設定で可能                                                                         | 設定なしで可能                                                                                                                                                                                                                                        |
| Cloudflare Workers                                                                            | 最低限の設定で可能                                                                         | 不可、 [作業中](https://github.com/vercel/next.js/discussions/34179#discussioncomment-3578259)                                                                                                                                                        |
| Node server (Docker, Heroku, Digital Ocean etc.)                                              | 最低限の設定で可能                                                                         | 制限はあるが可能                                                                                                                                                                                                                                      |
| Caching (see own section above)                                                               | No*, if needed, use industry-standard caching**.                                           | App Router [caching](https://nextjs.org/docs/app/building-your-application/caching), [opt-out](https://www.reddit.com/r/nextjs/comments/15wc4nt/nextjs_caching_opt_out/)   |

(\*) Vikeはデザイン上、そのような余分なものは行いません。
(\**) Industry-standard ways of caching is to use the HTTP Cache-Control header to [cache in the client's browser](https://web.dev/articles/http-cache) and potentially also on a shared/public [CDN](https://www.cloudflare.com/lp/ppc/cdn-x/) cache in front of your server side. Additionally, if you ever need even more caching than that, it's possible to have an in-memory cache on your server-side using e.g. [Redis](https://developer.redis.com/howtos/solutions/microservices/caching/) or Memcached.



## ユーザーの声

[@Axxxx0nより](https://github.com/vikejs/vike/issues/158#issuecomment-934224512):

1. Vite (オンデマンドトランスパイル、ネイティブESM)による高速開発。
1. Next.jsには多くのサンプルが必要であり、Next.jsとライブラリを統合するためのライブラリが数多く存在します（たとえば[next-i18next](https://github.com/isaachinman/next-i18next)）。Vikeなら、統合したいライブラリのドキュメントを読むだけでOKです。
1. Reactの新機能が登場したら、すぐに使い始めることができ、Next.jsチームが統合するのを待つ必要がありません。(ストリーミングAPI、サーバーコンポーネント、サーバー上のサスペンス、部分的なハイドレーションなど）。
1. Next.jsは、ビルド後に`/public`ディレクトリにあるファイル（ユーザーがアップロードした画像など）を読み込むことができません。
1. `getServerSideProps()`で、Next.jsはクライアントサイドのレンダリングをブロックします。
1. クライアントサイドのナビゲーション（[Next.js - &#35;23921](https://github.com/vercel/next.js/discussions/23921)）でデータ取得をバイパスすることはできません。
1. Next.jsはVercelプラットフォームを強力にプッシュしており、最近の機能アップデートに現れ始めています。Next.jsに沿った機能が優先される一方で、重要な修正は遅れています。
1. Next.jsはサーバーレスに傾倒しており、必要ないのに使い方が複雑になっています。


## UIフレームワークに囚われない

> Vike is completely agnostic to React and its source code has zero dependency on React. You can actually use Vike with any other UI Framework (Vue, Preact, Solid, etc.).
>
> With Vike, you implement and fully control the React integration, which has many benefits. For example, you can use Relay in the same way that Facebook does (with a render-as-you-fetch stream) which isn't possible with Next.js.                                              

Vikeでは、Reactを自分で統合します。つまり、もう少し定型文を書く必要がありますが、その代わりに柔軟性が増します。
You can even use [vike-react](https://vike.dev/react) to do it for you, and later when you need more control you can eject.                     
Reactを自分で統合するため、お気に入りのツールを用いたフロントエンドの統合（データ取得、状態管理、認証など）を完全に制御できます。

たとえば、Next.jsでは不可能な方法でRelayやApolloを使用できます。

> Relayは、（GraphQLを発明した）Facebookによって開発され、大規模に使用されている最先端のGraphQLクライアントである。YouTubeのビデオ 「[Re-introducing Relay](https://www.youtube.com/watch?v=lhVGdErZuN4) 」では、Relayの利点について詳しく説明しています。
> 多くのユーザーやスポンサーが、RelayとSSR Streamingを統合するVikeの柔軟性を活用しています。

Vikeにはクライアントサイドルーティング、HMR、ファイルシステムルーティング、プリレンダリング、データフェッチ、コード分割、レイアウト、i18nなどのフロントエンドフレームワークに期待されるものが全て含まれています。               


## Deployment/hosting agnostic

### Next.js

Next.js is made by [Vercel](https://vercel.com), a hosting provider. It is therefore naturally optimised to run in their environment and infrastructure. But Vercel
is
[known](https://eightify.app/summary/web-development/the-shift-from-vercel-to-aws-amplify-cost-and-scaling-benefits)
to
[become](https://www.reddit.com/r/nextjs/comments/12t5nhi/needed_alternatives_for_vercel/)
very
[expensive](https://x.com/zackerydev/status/1717556827569660378)
at
[scale](https://www.reddit.com/r/nextjs/comments/q7vw6p/cheaper_vercel_alternatives_specifically_to/hgm7d1t/).
What's worse is that [Vercel's pricing](https://vercel.com/pricing) is
misleading (the pay-per-developer make it seem cheap but you usually pay for very expensive fees for exceeding limits),
[opaque](https://www.reddit.com/r/nextjs/search?q=vercel+pricing&restrict_sr=on&include_over_18=on) (e.g. you must have an enterprise plan if you have >10 team members which is [hidden in the fine print](https://vercel.com/docs/limits/overview#:~:text=Team%20Members%20per,Custom)),
locks you in with [extremely expensive egress fees](https://gist.github.com/brillout/190bc676879a2a615d0bae031969f0a5),
hard to understand and nearly impossible to predict.
Such pricing is a no-go for large enterprises.

You can self-host Next.js as a Node.js server, for example placed in a Docker container. But it won't work precisely the same way as on Vercel.
Furthermore, self-hosting Next.js as a Serverless or Edge application (i.e. replacing Vercel) is worse.

An illustration of the problem: with Next.js server actions you no longer handwrite API endpoints - which means [you don't have the ability to explicitly control versioning](https://twitter.com/thdxr/status/1718308244383228124). So requests from old clients can fail. Vercel solved this with their deployment infrastructure, instead of in Next.js itself. So if you use Next.js but not Vercel then you'll have to deal with this major problem yourself.

These kinds of difficulties led the open source community to develop [Open-Next.js](https://open-next.js.org/), a project to make Serverless deployment of Next.js on generic Functions-as-a-Service (FaaS) platforms easier (specifically on AWS Lambda). It allows easier integration with AWS and reduces Next.js's ties to Vercel. But that is a moving target with things breaking frequently, [according to a person](https://x.com/thdxr/status/1740115107005280592) working closely with the matter.

Edge deployment with Next.js is another story. [Cloudflare](https://blog.cloudflare.com/next-on-pages), the most prominent edge hosting provider, uses its own runtime instead of Node.js. Meaning that some Next.js apps built to run on Node.js won't immediately work on the Edge. So Next.js has an Edge Runtime toolkit/mode that uses only a subset of the Node.js API, but it has [a lot of issues](https://github.com/search?q=repo%3Avercel%2Fnext.js+edge+runtime&type=issues).


### Vike

> With Vike, you keep full control over your server and you can use any deployment strategy.

Vike is server and deployment agnostic, which means you can use any hosting provider and any server/serverless setup of choice. Vike is built with Serverless and Edge compatibility from the start.

From a server perspective, <Link text="Vike is just a middleware" href="/deploy" /> that doesn't depend on Node.js and that can run anywhere where JavaScript runs such as AWS, Vercel, Cloudflare, Deno Deploy, or even in the browser.

You can develop apps with a server that doesn't depend on Node.js and deploy it anywhere.

> You can also <Link href="/pre-rendering">pre-render</Link> your app to remove the need for a production server: your app consists only of static assets (HTML, JS, CSS, images, ...) that can be deployed to any static host such as GitHub Pages.

> You do need Node.js for local development, as the development runtime of [Vite (the dev- and build-toolkit used by Vike)](https://vitejs.dev/) depends on Node.js. But Vite's runtime isn't needed in production. Consequently, since Vike's runtime doesn't depend on Node.js, there are no dependencies on Node.js in production.

To integrate Vike, you simply add Vike's middleware to your server (Express.js, Fastify, Edge Worker, Serverless Function, etc.).

With Vike, you have full control over your server and over your deployment strategy, two critical aspects of your business.



## Minimal and self-contained (no deps)

[All dependencies](https://github.com/vikejs/vike/blob/3d042da/vike/package.json#L15-L26) are either shared with Vite (e.g. [`fast-glob`](https://github.com/mrmlnc/fast-glob)) or fully owned (e.g. we own [`@brillout/json-serializer`](https://github.com/brillout/json-serializer)). Adding Vike to your Vite app doesn't add any frivolous dependency.

We believe Vike hits the sweet spot of being a full-fledged frontend tool while avoiding unnecessary bells and whistles.



## Caching by default vs. opt-in

### Next.js

Next.js aggressively uses [caching](https://nextjs.org/docs/app/building-your-application/caching), for performance and cost-saving reasons. Less server load means your app uses less compute resources, which saves you money on Vercel's paid plans, but saves Vercel money on their free tier (which most developers will be on; Vercel's long-tail).

Next.js leans towards making as many routes as possible statically rendered (SSG over SSR wherever possible). Caching is enabled by default (both on the server and the client), and you have to **explicitly opt-out** to disable it (using more or less hacky solutions) each time you don't want it.

But people are [finding](https://www.reddit.com/r/nextjs/comments/18tkmdb/has_anyone_abandoned_nextjs_after_using_it_on_a/kffjox2/) the aggressive [caching to be a nightmare](https://www.reddit.com/r/nextjs/comments/18tkmdb/has_anyone_abandoned_nextjs_after_using_it_on_a/kfh6nh2/), and hard to disable. Caching can give a wrong/stale view of your app, and cost precious development time hunting for the cause.

As the saying goes, _"There are only two hard things in Computer Science: cache invalidation and naming things."_ -- Phil Karlton

### Vike

Vike does not cache, by design, so by default your app will behave as you expect. If you do want caching, you can opt into it by using one of the many industry-standard caching tools.



## Server-first vs. granular work-split


### Next.js - server-first oriented

Next.js - made by Vercel, a hosting provider - is server-focused. It now defaults to interpreting all React components in the React render tree as React Server Components (RSC), and if you don't want that, you have to opt-out. 

With RSCs, you have to inject the bundler directive "use client" (aka. start client bundling) into your React component tree at the start of every branch with components that you want to turn into Client Components.

The default server orientation makes sense for _websites_ that consist of large static sections with no client interactivity. Using RSCs reduce the size of client-side bundles (and hydration), due to the JS code in RSC's only running on the server (e.g. useful for a static site using a heavy markdown library). But RSC's carry serialization and parsing overhead, has special rules (no state, context, or effects), and conceptual overhead that many developers struggle with.

In all, the fact that Next.js leans more on the server (and RSC's and caching by default) may not be what you want, especially if you are building a _webapp_ which you expect will become more and more dynamic and interactive anyway.

If your product either should be:

- leaning more towards being an _app_ than a _site/page_.
- having a lot of dynamically generated and/or frequently updating content (coming from a DB), where caching doesn't give a lot of gains.
- having a [single unified model for data loading](https://x.com/DevtoolsFM/status/1756091319632683073) that may include polling and [live UI updates](https://www.flightcontrol.dev/blog/nextjs-app-router-migration-the-good-bad-and-ugly#bad-have-to-add-client-side-fetching-for-live-ui-updates).
- local/offline-first, and/or a [PWA](https://web.dev/learn/pwa/assets-and-data#platform-specific_apps_vs_pwa).
- cross-platform (reusing code between web and native), since native platforms are typically client-centered (and it [isn't prioritized](https://github.com/reactjs/rfcs/blob/main/text/0188-server-components.md#what-does-it-mean-for-react-native) or very clear how React Server Components would work on React Native).
- using less server resources (scalability, cost-wise), in favor of requiring slightly more processing power on the client.

then the server-first orientation of Next.js and Vercel isn't helpful and can be a hindrance.


### Vike - granular work-split between server and client

With Vike, you can choose setups that fit the aforementioned use cases.
You can partially or completely opt out of SSR (turn on/off for whole app, <Link href="/ssr">for some pages</Link>, or <Link href="/ClientOnly">for some components</Link>).
You can also use SSR for the first page and then, from there on, use client-only navigation while fetching data directly from the data source (without involving your SSR server).

Vike has first-class support for leaning towards the client-side, as well as first-class support for SSR use cases.
Vike is made by the community and has no incentive to favor any side of the work-split between the client and the server.



## 手動での統合

上述の通り、Vikeの哲学は、フレームワークの決定に縛られることなく、手動でツールを統合できることげある。好きなツールを好きなように使えます。

総合的に見て、Vikeは簡単ではないが、よりシンプルです。大規模なプロジェクトでは、「簡単」であることよりも 「シンプル」であることの方が基本的に重要です。

最後になりますが、フレームワークと戦うのは厄介ですが、手動での統合は楽しく、洞察力に富みます。Vikeは、手動での統合を楽しむことができるフレームワークです。             


## React Server Components

React 18 introduced novel techniques that unlock many capabilities.

Vike, and in particular <Link href="/react#vike-react">`vike-react`</Link>, extensively leverages React's 18 new techniques. (<Link href="/streaming">Streaming</Link>, <Link href="/streaming#progressive-rendering">Progressive Rendering</Link>, independent and collocated data fetching, <Link href="/RPC">RPC</Link>, etc.)

Vike provides you with extensive control for integrating tools as you see fit, such as control over React's SSR <Link href="/streaming">stream</Link>. At the same time <a href="/extensions">Vike extensions</a> provide built-in integrations for a quick start. We call this dual approach <Link href="/why#optional-control">optional control</Link>.

One aspect `vike-react` doesn't support yet are components that are loaded only on the server-side. While we are researching a DX for such components, we believe this new paradigm is too early for being used in production. See <Link href="/react#react-server-components" doNotInferSectionTitle />.


## 独自のフレームワークを構築

Vikeは、ユーザーがVikeの上にフレームワークを構築できるようにゼロから設計されています。

わずか数百行のコードで、あなた自身のNext.jsを構築することができます。

> 独自のフレームワークを構築する[ユースケース](https://vike.land)はたくさんありますが、最も顕著なのは[企業内のフレームワークを構築](https://vike.land#scale)することです。

私たちは、特定のユースケースに高度に調整されたReactフレームワークの普及を促進しています。  

Read more at [Vike.land](https://vike.land).
